;
; Test for core features
; Small arguments of factorial
;

(define-values (factorial)
  (lambda (n)
    (letrec-values ([(loop)
                     (lambda (n acc)
                       (if (<= n 0)
                           acc
                           (loop (- n 1) (* n acc))))])
      (loop n 1))))


(if (equal? (factorial 0) 1)
    (void)
    (exit 1))

(if (equal? (factorial 1) 1)
    (void)
    (exit 2))

(if (equal? (factorial 2) 2)
    (void)
    (exit 3))

(if (equal? (factorial 3) 6)
    (void)
    (exit 4))

(if (equal? (factorial 4) 24)
    (void)
    (exit 5))

(if (equal? (factorial 5) 120)
    (void)
    (exit 6))

(if (equal? (factorial 10) 3628800)
    (void)
    (exit 7))
