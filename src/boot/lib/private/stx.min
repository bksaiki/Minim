;;;
;;; Additional syntax handling
;;;

(export identifier?
        stx-null? stx-pair? stx-list?
        stx-car stx-cdr)

(define (identifier? t)
  (if (syntax? t)
      (symbol? (syntax-e t))
      #f))

(define (stx-null? t)
  (if (null? t)
      #t
      (if (syntax? t)
          (null? (syntax-e t))
          #f)))

(define (stx-pair? t)
  (if (pair? t)
      #t
      (if (syntax? t)
          (pair? (syntax-e t))
          #f)))

(define (stx-car t)
  (if (pair? t)
      (car t)
      (car (syntax-e t))))

(define (stx-cdr t)
  (if (pair? t)
      (cdr t)
      (cdr (syntax-e t))))

(define (stx-list? t)
  (if (list? t)
      #t
      (if (syntax? t)
          (list? (syntax-e t))
          #f)))

; (define (stx-vector? t)
;   (if (vector? t)
;       #t
;       (if (syntax? t)
;           (vector? (syntax-e t))
;           #f)))
