;;;;;;;;;;;;;;;;;;; cond ;;;;;;;;;;;;;;;;;;;

(def-syntax cond
  (syntax-rules (else)
   [(_) (void)]
   [(_ [else body ...]) (begin body ...)]
   [(_ [else body ...] rest ...)
    (error 'cond "else only allowed in the last clause")]
   [(_ [test body ...] rest ...)
    (if test (begin body ...) (cond rest ...))]))

(def-syntax else
  (lambda (stx)
    (syntax-error 'else "not allowed as an expression" stx)))

(%export cond else)
